library("msmsTests")
vignette(package = "msmsTests")
vignette("msmsTests-Vignette",
package = "msmsTests")
data(msms.dataset)
dim(msms.dataset)
pData(msms.dataset)
table(msms.dataset$treat, msms.dataset$batch)
library(msmsEDA)
counts.pca(msms.dataset)
## alt.f <- "y ~ treat"
alt.f <- "y ~ treat + batch"
### Normalizing condition
div <- apply(exprs(msms.dataset),2,sum)
## run the negative binomial test for
## count data
res <- msms.edgeR(
msms.dataset,
alt.f,
null.f,
div = div,
fnm = "treat")
## adjust the p-values using the
## Benjamini Hochberg method
res$padj <- p.adjust(res$p.value, method = "BH")
null.f <- "y ~ batch"
## alt.f <- "y ~ treat"
alt.f <- "y ~ treat + batch"
### Normalizing condition
div <- apply(exprs(msms.dataset),2,sum)
## run the negative binomial test for
## count data
res <- msms.edgeR(
msms.dataset,
alt.f,
null.f,
div = div,
fnm = "treat")
## adjust the p-values using the
## Benjamini Hochberg method
res$padj <- p.adjust(res$p.value, method = "BH")
## a data.frame
head(res)
## check that the order has been maintained
identical(featureNames(msms.dataset),
rownames(res))
## add the stats results to the MSnSet's
## feature data
fData(msms.dataset) <-
cbind(fData(msms.dataset), res)
## check that the order has been maintained
identical(featureNames(msms.dataset),
rownames(res))
x1 = msnset[1:10, ]
x2 = msnset[11:30, ]
x3 = msnset[31:55, ]
l = list(x1, x2, x3)
l
x1
dim(x1)
tab(x1)
table(x1)
colnames(x1)
rownames(x1)
dim(msnset)
pData(msnset)
fdata(msnset)
fData(msnset)
View(fData(msnset))
View(pData(msnset))
x1 = msnset[1:10, ]
x2 = msnset[11:30, ]
x3 = msnset[31:55, ]
l = list(x1, x2, x3)
res = do.call(combine, l)
set.seed(11)
m <- matrix(sample(0:5, 12, replace = TRUE), nrow = 4)
m[4, 1] <- 2
m
colnames(m) <- LETTERS[1:3]
m
rownames(m) <- letters[1:4]
m
a <- readMSnSet2(as.data.frame(m), eco = 1:3)
fData(a)$notZero <- rowSums(exprs(a) != 0)
fData(a)$rws <- rowSums(exprs(a))
fData(a)$fac <- fData(a)$rws * fData(a)$notZero
a
View(fData(a))
View(pData(a))
x1 = msnset[1:10, ]
x2 = msnset[11:30, ]
x3 = msnset[31:55, ]
l = list(x1, x2, x3)
res = do.call(combine, l)
set.seed(11)
m <- matrix(sample(0:5, 12, replace = TRUE), nrow = 4)
m[4, 1] <- 2
m
colnames(m) <- LETTERS[1:3]
rownames(m) <- letters[1:4]
m
a <- readMSnSet2(as.data.frame(m), eco = 1:3)
colnames(a)
rownames(a)
a
View(a)
pData(a)
str(pData(a))
View(pData(a))
fData(a)
View(fData(a))
