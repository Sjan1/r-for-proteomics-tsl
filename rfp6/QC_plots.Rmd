---
title: "PDLP1 reanalysis, QC-plots"
author: "Jan Sklenar"
#date: "25 November 2018"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=TRUE}
knitr::opts_chunk$set(fig.width=12, fig.height=8, fig.path='Figs/',
                      echo=TRUE, warning=FALSE, message=FALSE)

```

### Start
```{R, libraries, eval=TRUE}
#source("https://bioconductor.org/biocLite.R")
#biocLite("biobroom")
library("biobroom")
library("magrittr")
library("ggplot2")
library("plyr")
```

### Tidy MSnSet object containig the data
```{R, read data, cache=TRUE, eval=TRUE}

if (require("MSnbase")) {
  library(MSnbase)
  # import MSnSet object
eprot <- readRDS("eprot.rds")
  #already imported...
  
  # Use tidy to extract genes, sample ids and measured value
  tidy(eprot)
  # add phenoType data
  et <- tidy(eprot, addPheno=TRUE)
}
saveRDS(et,"et.rds")
et <- readRDS("et.rds")
```

### Subsets of data
```{R, filter, cache=FALSE, eval=TRUE}
library("dplyr")
et_c <- et %>% filter(phenotype == "C")
et_p <- et %>% filter(phenotype == "P")
et_h <- et %>% filter(treatment == "H")
et_i <- et %>% filter(treatment == "I")
```
### Plots
```{R, plots, fig.height=2}
library("ggplot2")
ggplot(et_c) + aes(x=sample) + geom_bar(aes(weight=value, fill=treatment))
ggplot(et_p) + aes(x=sample) + geom_bar(aes(weight=value, fill=treatment))
ggplot(et_h) + aes(x=sample) + geom_bar(aes(weight=value, fill=phenotype))
ggplot(et_i) + aes(x=sample) + geom_bar(aes(weight=value, fill=phenotype))

```